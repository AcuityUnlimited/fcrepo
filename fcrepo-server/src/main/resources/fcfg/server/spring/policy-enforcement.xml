<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context-3.0.xsd">
        <bean id="org.fcrepo.server.security.ContextAttributeFinderModule"
              class="org.fcrepo.server.security.ContextAttributeFinderModule"
              factory-method="getInstance" autowire-candidate="true">
        </bean>
        <bean id="org.fcrepo.server.security.ResourceAttributeFinderModule"
              class="org.fcrepo.server.security.ResourceAttributeFinderModule"
              factory-method="getInstance" autowire-candidate="true">
              <property name="ownerIdSeparator" value="," />
              <property name="DOManager" ref="org.fcrepo.server.storage.DOManager" />
        </bean>
        
        <bean id="org.fcrepo.server.security.xacml.pdp.finder.attribute.FedoraRIAttributeFinder"
              class="org.fcrepo.server.security.xacml.pdp.finder.attribute.FedoraRIAttributeFinder">
              <property name="resourceAttributes">
                <set>
                  <value>info:fedora/fedora-system:def/view#mimeType</value>
                  <value>info:fedora/fedora-system:def/model#ownerId</value>
                  <value>info:fedora/fedora-system:def/model#state</value>
                  <value>info:fedora/fedora-system:def/model#createdDate</value>
                  <value>info:fedora/fedora-system:def/model#label</value>
                  <value>http://www.w3.org/1999/02/22-rdf-syntax-ns#type</value>
                  <value>http://muradora.ramp.org.au/sf#isSmartFolder</value>
                </set>
              </property>
        </bean>
        
        <bean id="org.fcrepo.server.security.PolicyEnforcementPoint"
              class="org.fcrepo.server.security.PolicyEnforcementPoint"
              factory-method="getInstance" autowire-candidate="true">
              <property name="attributeFinderModules">
                  <list>
                      <ref bean="org.fcrepo.server.security.ResourceAttributeFinderModule" />
                      <ref bean="org.fcrepo.server.security.ContextAttributeFinderModule" />
                      <ref bean="org.fcrepo.server.security.xacml.pdp.finder.attribute.FedoraRIAttributeFinder" />
                  </list>
              </property>
        </bean>
</beans>